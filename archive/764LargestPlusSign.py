class Solution:

    def orderOfLargestPlusSign(self, N, mines):
        """
        :type N: int
        :type mines: List[List[int]]
        :rtype: int
        """
        grid = [[1] * N for _ in range(N)]
        for mine in mines:
            grid[mine[0]][mine[1]] = 0

        left = [[None] * N for _ in range(N)]
        up = [[None] * N for _ in range(N)]
        right = [[None] * N for _ in range(N)]
        down = [[None] * N for _ in range(N)]

        for x in range(N):
            for y in range(N):
                if grid[x][y]:
                    if y == 0:
                        left[x][y] = 0
                    else:
                        left[x][y] = left[x][y - 1] + 1
                    if x == 0:
                        up[x][y] = 0
                    else:
                        up[x][y] = up[x - 1][y] + 1
                else:
                    left[x][y] = -1
                    up[x][y] = -1
        for x in range(N - 1, -1, -1):
            for y in range(N - 1, -1, -1):
                if grid[x][y]:
                    if y == N - 1:
                        right[x][y] = 0
                    else:
                        right[x][y] = right[x][y + 1] + 1
                    if x == N - 1:
                        down[x][y] = 0
                    else:
                        down[x][y] = down[x + 1][y] + 1
                else:
                    right[x][y] = -1
                    down[x][y] = -1

        ans = max([min(left[x][y], right[x][y], up[x][y], down[x][y]) for x in range(N) for y in range(N)]) + 1
        return ans


N = 5
mines = [[4, 2]]
# N = 1
# mines = [[0, 0]]

N = 500
mines = [[0, 38], [0, 44], [0, 211], [0, 256], [1, 287], [1, 376], [2, 385], [3, 191], [3, 316], [3, 360], [4, 427], [5, 62], [6, 287], [7, 88], [7, 166], [7, 368], [7, 391], [7, 490], [9, 25], [9, 264], [9, 292], [9, 307], [9, 323], [10, 124], [10, 137], [10, 235], [10, 301], [11, 221], [11, 228], [11, 475], [11, 486], [12, 326], [12, 444], [13, 73], [13, 434], [13, 485], [14, 45], [14, 218], [15, 261], [15, 368], [16, 87], [16, 129], [16, 139], [16, 267], [16, 270], [17, 46], [17, 326], [17, 368], [17, 426], [18, 452], [18, 458], [18, 496], [19, 50], [19, 216], [20, 91], [20, 204], [21, 326], [21, 385], [22, 28], [22, 161], [22, 320], [22, 440], [22, 464], [22, 497], [23, 73], [23, 176], [23, 407], [24, 18], [24, 230], [24, 305], [25, 38], [25, 157], [25, 485], [26, 458], [27, 123], [27, 488], [28, 332], [28, 445], [29, 185], [29, 254], [30, 136], [30, 250], [30, 322], [30, 340], [31, 264], [32, 359], [33, 438], [34, 177], [34, 244], [34, 379], [35, 246], [35, 271], [35, 481], [37, 212], [37, 326], [37, 439], [38, 31], [38, 144], [39, 119], [40, 60], [40, 269], [40, 374], [41, 73], [41, 220], [42, 91], [42, 194], [43, 434], [44, 232], [45, 3], [45, 44], [45, 107], [45, 484], [46, 324], [46, 342], [47, 29], [47, 306], [47, 461], [48, 7], [49, 135], [49, 454], [50, 211], [51, 212], [52, 212], [52, 232], [52, 387], [52, 433], [52, 485], [54, 177], [54, 199], [54, 250], [54, 328], [56, 96], [56, 123], [56, 401], [57, 100], [57, 413], [58, 7], [58, 214], [58, 217], [58, 226], [59, 434], [59, 474], [60, 270], [61, 118], [61, 139], [61, 233], [61, 280], [62, 189], [64, 12], [64, 23], [64, 96], [64, 191], [64, 331], [64, 478], [65, 132], [65, 310], [66, 79], [66, 189], [66, 349], [67, 61], [67, 241], [68, 99], [68, 140], [68, 405], [69, 58], [69, 381], [70, 0], [70, 141], [70, 196], [70, 319], [71, 68], [71, 153], [71, 306], [72, 48], [72, 62], [72, 102], [72, 157], [72, 244], [72, 400], [73, 180], [73, 283], [73, 321], [73, 329], [73, 393], [73, 425], [74, 246], [75, 63], [75, 498], [76, 194], [76, 207], [76, 366], [77, 239], [77, 483], [78, 58], [78, 420], [79, 404], [79, 427], [81, 294], [82, 20], [82, 27], [82, 196], [82, 251], [82, 432], [83, 31], [84, 117], [84, 433], [85, 88], [85, 191], [85, 286], [86, 33], [86, 236], [86, 303], [86, 363], [86, 455], [87, 277], [89, 5], [89, 109], [89, 204], [89, 233], [89, 412], [90, 106], [90, 227], [90, 231], [90, 246], [90, 247], [90, 252], [90, 316], [91, 216], [91, 267], [91, 330], [93, 83], [93, 289], [93, 350], [95, 81], [95, 247], [95, 304], [96, 36], [96, 40], [96, 42], [96, 338], [96, 434], [97, 1], [97, 85], [97, 284], [97, 291], [97, 481], [98, 159], [99, 315], [99, 333], [100, 63], [100, 87], [101, 120], [102, 38], [102, 47], [102, 80], [102, 82], [102, 96], [103, 214], [103, 318], [103, 355], [104, 258], [105, 173], [106, 206], [107, 199], [107, 439], [107, 446], [109, 241], [110, 39], [111, 219], [111, 410], [112, 64], [112, 94], [112, 373], [112, 462], [113, 124], [113, 133], [114, 171], [114, 298], [114, 483], [115, 116], [115, 168], [115, 282], [115, 355], [116, 101], [116, 329], [117, 342], [118, 167], [119, 228], [120, 208], [120, 337], [121, 109], [121, 215], [121, 388], [122, 302], [123, 78], [123, 228], [123, 397], [123, 410], [124, 163], [124, 165], [124, 264], [124, 364], [124, 405], [125, 115], [125, 298], [125, 423], [125, 498], [126, 104], [126, 260], [126, 447], [127, 215], [127, 436], [128, 11], [129, 74], [129, 483], [130, 323], [130, 438], [130, 452], [131, 151], [131, 339], [132, 423], [133, 242], [134, 82], [134, 395], [134, 398], [134, 418], [134, 444], [134, 466], [135, 333], [136, 16], [136, 22], [136, 167], [136, 209], [137, 77], [137, 389], [138, 58], [138, 274], [138, 356], [139, 311], [139, 395], [140, 47], [141, 54], [141, 349], [142, 199], [142, 205], [142, 241], [142, 449], [143, 58], [143, 362], [144, 193], [144, 254], [144, 338], [144, 339], [144, 370], [145, 442], [145, 450], [147, 483], [148, 107], [148, 361], [148, 397], [148, 492], [149, 144], [149, 351], [149, 362], [149, 425], [150, 376], [150, 477], [151, 123], [152, 261], [153, 190], [153, 257], [153, 447], [154, 26], [154, 312], [155, 4], [155, 212], [155, 335], [156, 116], [156, 269], [156, 312], [156, 376], [156, 468], [158, 32], [158, 129], [158, 131], [158, 146], [158, 193], [158, 223], [160, 199], [160, 320], [160, 372], [161, 39], [161, 91], [161, 446], [162, 103], [162, 132], [162, 386], [162, 462], [163, 23], [163, 306], [163, 468], [163, 470], [164, 123], [164, 452], [164, 478], [165, 195], [166, 121], [166, 134], [166, 412], [166, 441], [167, 201], [167, 261], [167, 264], [168, 224], [168, 308], [168, 319], [169, 3], [169, 198], [169, 470], [170, 400], [170, 402], [170, 404], [170, 405], [170, 470], [172, 98], [173, 341], [174, 83], [175, 15], [175, 124], [175, 205], [175, 236], [175, 409], [176, 178], [176, 216], [176, 265], [176, 333], [176, 481], [177, 252], [177, 390], [178, 86], [178, 135], [178, 494], [179, 228], [179, 406], [180, 53], [180, 180], [180, 231], [180, 234], [180, 290], [181, 481], [182, 280], [183, 132], [183, 240], [184, 104], [184, 231], [184, 287], [186, 3], [186, 453], [187, 17], [187, 35], [187, 51], [187, 73], [187, 212], [187, 305], [187, 371], [187, 457], [189, 120], [189, 152], [189, 256], [190, 48], [190, 208], [190, 390], [190, 415], [191, 324], [191, 463], [191, 490], [192, 15], [192, 313], [193, 92], [193, 410], [194, 3], [194, 273], [194, 458], [195, 208], [195, 232], [196, 25], [196, 89], [196, 291], [197, 235], [197, 306], [197, 425], [198, 36], [198, 40], [198, 267], [198, 494], [200, 92], [200, 208], [200, 332], [200, 406], [201, 125], [202, 322], [202, 368], [202, 444], [203, 233], [203, 352], [204, 61], [204, 146], [204, 323], [205, 188], [205, 290], [207, 238], [207, 289], [207, 329], [208, 373], [208, 401], [209, 44], [209, 100], [209, 432], [210, 126], [210, 415], [211, 397], [211, 401], [211, 402], [212, 139], [212, 223], [212, 289], [212, 412], [212, 429], [213, 94], [214, 212], [215, 5], [215, 36], [215, 280], [215, 455], [216, 112], [216, 297], [217, 143], [218, 63], [219, 68], [219, 96], [220, 105], [220, 158], [220, 485], [222, 31], [222, 45], [222, 395], [223, 141], [224, 31], [224, 251], [224, 416], [225, 468], [226, 368], [227, 144], [227, 167], [228, 159], [228, 233], [229, 81], [229, 121], [229, 159], [229, 210], [229, 294], [229, 351], [229, 372], [230, 294], [230, 337], [231, 67], [231, 160], [231, 465], [232, 107], [233, 77], [233, 195], [233, 457], [235, 114], [235, 161], [235, 310], [235, 343], [236, 331], [237, 223], [237, 339], [238, 73], [238, 202], [238, 334], [239, 113], [239, 237], [239, 341], [239, 456], [240, 157], [241, 159], [241, 359], [243, 106], [243, 285], [243, 390], [244, 98], [244, 264], [244, 336], [244, 406], [245, 0], [246, 259], [246, 265], [246, 328], [246, 399], [248, 123], [248, 131], [248, 207], [248, 349], [248, 400], [249, 465], [250, 96], [250, 152], [250, 361], [251, 42], [251, 167], [251, 306], [251, 320], [251, 361], [251, 393], [251, 412], [252, 72], [252, 318], [252, 342], [253, 30], [253, 74], [253, 126], [253, 438], [254, 384], [254, 478], [255, 216], [255, 248], [256, 278], [256, 360], [256, 375], [257, 92], [257, 470], [258, 282], [259, 117], [259, 387], [260, 228], [260, 472], [262, 10], [262, 121], [262, 152], [262, 181], [263, 217], [263, 295], [264, 65], [264, 185], [264, 371], [265, 464], [265, 484], [266, 335], [267, 12], [267, 30], [267, 81], [267, 331], [267, 400], [268, 347], [268, 451], [269, 3], [269, 156], [269, 396], [270, 151], [271, 37], [271, 460], [272, 1], [272, 334], [273, 160], [273, 357], [274, 387], [275, 39], [275, 126], [276, 101], [276, 119], [276, 163], [276, 210], [276, 228], [277, 445], [277, 477], [278, 171], [278, 267], [278, 315], [279, 62], [279, 74], [279, 234], [279, 255], [280, 340], [280, 456], [281, 99], [281, 422], [281, 434], [282, 89], [282, 246], [282, 343], [282, 362], [283, 314], [283, 367], [283, 395], [285, 261], [286, 7], [286, 32], [286, 108], [286, 127], [287, 58], [287, 152], [287, 280], [287, 489], [288, 336], [288, 379], [288, 417], [289, 134], [290, 304], [290, 436], [290, 465], [290, 498], [291, 173], [291, 189], [291, 224], [291, 428], [292, 345], [292, 409], [293, 80], [294, 30], [294, 211], [294, 348], [295, 13], [295, 363], [295, 386], [295, 474], [296, 60], [296, 241], [297, 23], [297, 368], [297, 457], [298, 450], [299, 36], [299, 144], [299, 174], [299, 345], [299, 414], [301, 404], [302, 391], [303, 125], [303, 389], [303, 392], [303, 438], [304, 25], [304, 99], [304, 102], [304, 115], [305, 302], [306, 220], [307, 11], [307, 73], [307, 320], [308, 145], [308, 154], [308, 472], [309, 70], [309, 106], [309, 289], [310, 34], [310, 44], [310, 480], [311, 67], [311, 205], [311, 217], [311, 337], [311, 454], [312, 110], [312, 195], [313, 81], [313, 99], [314, 40], [314, 157], [314, 199], [314, 219], [315, 6], [315, 229], [315, 311], [315, 347], [316, 220], [316, 296], [317, 477], [317, 491], [317, 497], [318, 395], [319, 249], [320, 170], [320, 188], [320, 266], [320, 468], [320, 481], [321, 159], [322, 128], [322, 203], [322, 473], [323, 42], [323, 46], [324, 81], [325, 40], [325, 351], [325, 375], [325, 484], [326, 228], [327, 12], [327, 97], [327, 219], [328, 15], [328, 124], [328, 130], [328, 317], [328, 373], [329, 185], [329, 366], [330, 137], [330, 329], [330, 408], [332, 174], [332, 266], [332, 365], [332, 494], [333, 211], [333, 482], [334, 80], [334, 246], [334, 352], [335, 96], [336, 321], [336, 360], [336, 428], [336, 469], [337, 333], [337, 389], [338, 392], [340, 46], [340, 383], [341, 249], [342, 185], [342, 298], [342, 397], [343, 107], [343, 162], [343, 436], [343, 478], [345, 181], [346, 204], [346, 355], [347, 332], [347, 427], [348, 130], [348, 282], [349, 251], [349, 367], [350, 299], [351, 302], [351, 324], [351, 352], [352, 290], [352, 331], [353, 123], [354, 233], [355, 345], [355, 440], [356, 370], [357, 304], [357, 401], [358, 46], [358, 96], [358, 169], [358, 409], [358, 415], [358, 452], [359, 132], [360, 100], [360, 177], [360, 268], [360, 347], [361, 90], [362, 124], [362, 495], [363, 5], [363, 128], [363, 169], [364, 44], [364, 466], [365, 177], [366, 154], [366, 246], [366, 259], [366, 375], [366, 416], [367, 454], [368, 66], [368, 282], [368, 402], [368, 449], [368, 476], [369, 480], [370, 8], [370, 65], [370, 105], [370, 402], [371, 84], [371, 180], [372, 24], [372, 115], [372, 250], [372, 278], [372, 452], [373, 140], [376, 211], [376, 220], [376, 469], [377, 11], [378, 220], [378, 280], [378, 291], [379, 46], [379, 172], [379, 217], [380, 111], [381, 117], [381, 427], [382, 172], [382, 248], [383, 72], [383, 288], [384, 109], [385, 150], [385, 472], [386, 140], [386, 381], [386, 421], [387, 115], [387, 166], [387, 370], [388, 144], [388, 370], [389, 39], [389, 75], [389, 272], [390, 363], [390, 438], [391, 74], [391, 95], [391, 143], [391, 146], [391, 422], [392, 67], [392, 122], [392, 493], [393, 275], [393, 312], [394, 229], [394, 291], [394, 348], [395, 411], [396, 12], [396, 351], [396, 431], [397, 102], [397, 354], [397, 396], [398, 119], [398, 364], [399, 314], [399, 422], [400, 218], [400, 303], [400, 347], [401, 342], [401, 489], [402, 57], [402, 62], [402, 403], [402, 470], [403, 311], [404, 5], [405, 1], [405, 219], [405, 341], [407, 72], [407, 93], [407, 181], [407, 188], [407, 214], [407, 240], [407, 285], [407, 457], [408, 10], [408, 99], [408, 119], [408, 484], [409, 203], [409, 242], [409, 259], [409, 389], [410, 3], [410, 433], [411, 259], [411, 441], [412, 6], [412, 108], [412, 214], [412, 394], [413, 184], [413, 223], [414, 11], [414, 478], [415, 391], [416, 59], [416, 75], [416, 145], [416, 151], [416, 337], [416, 377], [416, 411], [417, 348], [417, 434], [418, 170], [418, 281], [418, 301], [418, 404], [419, 78], [419, 109], [419, 200], [420, 23], [421, 71], [421, 228], [421, 322], [422, 74], [422, 103], [422, 167], [422, 412], [422, 472], [423, 10], [423, 76], [423, 303], [423, 407], [423, 464], [424, 4], [424, 260], [425, 337], [425, 415], [426, 76], [427, 263], [427, 283], [427, 486], [428, 470], [429, 349], [429, 392], [429, 485], [430, 395], [432, 56], [432, 344], [433, 152], [433, 291], [434, 215], [434, 296], [435, 104], [435, 282], [435, 303], [435, 322], [435, 364], [436, 278], [438, 43], [438, 196], [438, 363], [438, 476], [438, 497], [439, 282], [440, 195], [441, 182], [441, 229], [442, 248], [442, 347], [442, 499], [443, 285], [443, 421], [443, 451], [445, 126], [445, 149], [445, 154], [445, 184], [445, 280], [445, 461], [446, 52], [446, 409], [447, 148], [447, 266], [447, 284], [447, 365], [447, 395], [447, 426], [448, 292], [449, 33], [449, 40], [449, 72], [449, 197], [449, 344], [449, 399], [449, 491], [450, 301], [451, 488], [452, 57], [452, 107], [452, 235], [452, 436], [453, 65], [453, 197], [453, 231], [453, 328], [453, 337], [454, 152], [454, 163], [454, 251], [454, 272], [454, 296], [454, 324], [455, 3], [455, 41], [455, 179], [455, 205], [455, 229], [455, 268], [455, 406], [455, 452], [456, 173], [456, 234], [456, 283], [456, 382], [457, 21], [458, 59], [458, 140], [458, 195], [458, 251], [458, 323], [459, 75], [459, 134], [459, 210], [460, 321], [460, 325], [461, 384], [463, 330], [464, 63], [464, 117], [464, 224], [464, 314], [465, 240], [466, 31], [467, 161], [468, 96], [468, 129], [468, 255], [468, 325], [468, 417], [469, 44], [469, 255], [469, 285], [469, 352], [469, 483], [470, 75], [471, 144], [472, 14], [472, 84], [472, 187], [472, 346], [472, 466], [472, 488], [473, 12], [473, 24], [473, 462], [474, 110], [474, 209], [474, 494], [475, 418], [475, 432], [476, 138], [476, 220], [476, 311], [476, 380], [476, 434], [477, 39], [477, 325], [478, 87], [478, 425], [479, 77], [479, 384], [480, 73], [480, 225], [481, 150], [481, 348], [483, 101], [483, 313], [483, 426], [483, 433], [484, 334], [484, 404], [485, 460], [486, 38], [486, 252], [488, 36], [488, 302], [488, 484], [489, 148], [489, 261], [489, 298], [489, 300], [489, 302], [490, 156], [490, 473], [491, 254], [491, 284], [492, 196], [493, 20], [493, 119], [493, 310], [494, 44], [494, 379], [494, 402], [494, 423], [495, 31], [495, 148], [495, 160], [496, 69], [496, 166], [496, 232], [496, 299], [496, 305], [496, 364], [497, 8], [497, 309], [497, 365], [497, 420], [498, 315], [499, 76], [499, 226]]
print(Solution().orderOfLargestPlusSign(N, mines))
